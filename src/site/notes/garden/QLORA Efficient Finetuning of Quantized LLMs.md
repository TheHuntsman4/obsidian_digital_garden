---
{"dg-publish":true,"permalink":"/garden/qlora-efficient-finetuning-of-quantized-ll-ms/"}
---

23.04.25

**Paper Link: "https://proceedings.neurips.cc/paper_files/paper/2023/file/1feb87871436031bdc0f2beaa62a049b-Paper-Conference.pdf"**

- **Methodology used:** This paper introduces **QLoRA (Quantization-aware Low-Rank Adapter tuning)**. The methodology involves **quantizing a pretrained language model to 4-bit NormalFloat (NF4)**. This NF4 data type is designed to more accurately represent the weights of pretrained models, which are often normally distributed. The **quantized model is then frozen**, and **low-rank adapter layers (LoRA)** are added and trained. To manage memory efficiently, QLoRA utilizes **paged Adam and paged optimizers**, which allow for finetuning of very large models on a single GPU with limited memory. The paper includes **empirical evaluations** on several recent instruction-following datasets, comparing QLoRA to full 16-bit finetuning and other parameter-efficient methods.
    
- **New things introduced/ Novelty:** The primary novelty is the **QLoRA finetuning approach**, which combines **4-bit NF4 quantization of the base language model with the use of low-rank adapters for learning task-specific knowledge**. The introduction and application of the **NF4 data type, specifically designed for pretrained model weights**, is a significant contribution. Furthermore, the development and use of **paged optimizers** to overcome memory limitations during large model finetuning are novel aspects of this work. The paper demonstrates that QLoRA can **achieve performance comparable to full 16-bit finetuning** with substantially reduced memory requirements.
    
- **Key take aways and results:** A key takeaway is that **QLoRA can match the performance of full 16-bit finetuning** on a variety of instruction-following datasets. The use of **NF4 quantization is crucial for preserving the accuracy** of the 4-bit quantized models. **LoRA adapters prove to be effective** for learning new tasks when trained on top of a frozen, quantized base model. The **paged optimizers enable the finetuning of models with 33 billion and 65 billion parameters** on a single GPU.
    
- **Comparison with State of the Art (SOTA) and how better it is and under what circumstances:** The paper compares QLoRA primarily to **full 16-bit finetuning** and other **Parameter Efficient Fine-Tuning (PEFT) methods**. The results indicate that QLoRA can achieve **similar or better performance than full finetuning** while being significantly more **memory-efficient**, allowing for the finetuning of much larger models on accessible hardware. While other PEFT methods like prompt tuning and adapter methods exist, QLoRA's unique combination with quantization and the achieved performance levels establish it as a new state-of-the-art in memory-efficient finetuning for large language models.
    
- **Drawbacks that are discussed in the paper:** The authors mention that their qualitative study is **not entirely comprehensive** due to the difficulty of controlling all variables involved in model response generation. They acknowledge that they rely on samples of model outputs, hoping they are representative. While **paged optimizers** are crucial, the paper **does not provide hard measurements** specifically for their performance gains. The study primarily focuses on LoRA adapters, and the **trade-offs with other PEFT methods are left for future exploration**.
    
- **Improvements that can be made:** Future research could explore the **integration of QLoRA with other PEFT techniques** to potentially further enhance performance or efficiency. Investigating the effectiveness of QLoRA on a broader range of tasks, model architectures, and languages could provide further insights. More detailed quantitative analysis of the **benefits of paged optimizers** would be valuable. Additionally, a more comprehensive qualitative study that attempts to control for more variables in the model's response generation could provide a deeper understanding of QLoRA's capabilities and limitations.
